#!/bin/bash
# Czarina Worker Auto-Init
# This script helps workers discover their role and setup

CZARINA_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
CONFIG_FILE="$CZARINA_DIR/config.json"

if [ ! -f "$CONFIG_FILE" ]; then
    echo "‚ùå Config file not found: $CONFIG_FILE"
    exit 1
fi

# Show available workers
echo "üìã Available workers:"
jq -r '.workers[] | "  ‚Ä¢ \(.id) - \(.description)"' "$CONFIG_FILE"
echo ""

# If worker ID provided, load it
if [ -n "$1" ]; then
    WORKER_ID="$1"
    WORKER_FILE="$CZARINA_DIR/workers/$WORKER_ID.md"

    if [ -f "$WORKER_FILE" ]; then
        echo "‚úÖ Loading worker: $WORKER_ID"
        cat "$WORKER_FILE"
    else
        echo "‚ùå Worker file not found: $WORKER_FILE"
        exit 1
    fi
else
    echo "üí° Usage: ./.czarina/.worker-init <worker-id>"
fi
